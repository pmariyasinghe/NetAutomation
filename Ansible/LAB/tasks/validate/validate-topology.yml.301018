---
##### COMMAND: ansible-playbook -i hosts tasks/validate/validate-topology.yml -u admin --ask-pass
- name: Generate Topology config
  hosts: veos-lab
  tasks:
  - template: src=/vagrant/NetAutomation/Ansible/LAB/templates/{{dev_os}}/topology_validation.j2 dest=/vagrant/NetAutomation/Ansible/LAB/ConfigRepos/topology/{{hostname}}_topology

- name: Create topology log file for each host  if doesnt exist
  hosts: veos-lab
  tasks:
  - file: path=/vagrant/NetAutomation/Ansible/LAB/ConfigRepos/LOGS/{{hostname}}_topology.log state=touch

- name: Topology validation
  hosts: veos-lab
  tasks:
  - script: /usr/bin/python /vagrant/NetAutomation/Ansible/LAB/scripts/lab_show_lldp_neighbours.py {{hostname}} /vagrant/NetAutomation/Ansible/LAB/ConfigRepos/topology/{{hostname}}_topology {{ansible_ssh_pass}}

- name: Topology validation - update results
  hosts: veos-lab
  tasks:
  - template: src=~/ansible/CFG/HPN/REPOS/LAB/topology/{{hostname}}_topology dest=~/ansible/CFG/HPN/REPOS/LAB/topology/{{hostname}}_topology

##- name: Topology validation
##  script: /usr/bin/python ~/ansible/roles/LAB/HPN/scripts/lab_show_lldp_neighbours.py {{item.hostname}} {"Neighbors":{{item.topology}}} {{ansible_user}} {{ansible_ssh_pass}}
##  with_items: LAB_TOPOLOGY

